{% extends "warehouse/base.html" %}
{% load staticfiles tethys_gizmos tags %}


{% block styles %}
{{ block.super }}
<link href="{% static 'tethys_apps/css/app_library.css' %}" rel="stylesheet"/>
<link href="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.css" rel="stylesheet">
{% endblock %}

{% block import_gizmos %}
    {% import_gizmo_dependency select_input %}
{% endblock %}


{% block header_buttons %}
<div class="header-button glyphicon-button" data-toggle="tooltip" data-placement="bottom" title="Help">
    <a data-toggle="modal" data-target="#help-modal"><span class="glyphicon glyphicon-question-sign"></span></a>
</div>
{% endblock %}

{% block app_content %}
<div class="card card-default main-app-list">
    <div class="card-header">Available Tethys Applications</div>
    <div class="card-body">
        <div id="toolbar">
        </div>
        <table data-toggle="table" data-search="true" data-show-search-clear-button="true" data-toolbar="#toolbar" data-show-columns="true" id="mainAppsTable" data-show-toggle="true" data-detail-view="true" data-detail-formatter="detailFormatter">
            <thead>
                <tr>
                    <th>Tethys App Name</th>
                    <th>Latest Version</th>
                    <th>Developer</th>
                    <th data-field="operate" data-formatter="operateFormatter" data-events="operateEvents">Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for resource in resources %}
                <tr>
                    <td data-install-url="{% url 'warehouse:install' %}?name={{ resource.name }}" data-app-id="{{ forloop.counter0 }}">{{ resource.name }}</td>
                    <td>{{ resource.metadata.versions|last }}</td>
                    <td>{{ resource.metadata.author }}</td>
                    <td>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="card-footer ">
    </div>
</div>

<!-- <div class="app-library-wrapper clearfix">
    {% if resources %}
    <div class="container" align="center">
        <div class="row">
            <div class="col-sm-12 col-xs-12">
                <div class="filter-container isotopeFilters">
                    <ul class="list-inline filter">
                        <li><a href="#" data-filter="*" class="tag-button active">All </a></li>
                        {% for tag in tags%}
                        {% if tag %}
                        <li><a href="#" data-filter=".{{ tag }}" class="tag-button">{{ tag }}</a></li>
                        {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div id="app-list" class="isotopeContainer">
        {% for resource in resources %}
        <a class="app-container isotopeSelector {{resource.tag_class}}" id="app_button_{{resource.name}}" data-app-name="{{ resource.name }}"
           data-install-url="{% url 'warehouse:install' %}?name={{ resource.name }}">
            <div class="app-icon">
                <img {% if resource.metadata.icon %}
                     src="{% static resource.metadata.icon %}"
                     {% else%} src="{% static 'tethys_apps/images/default_app_icon.gif' %}"
                     {% endif %}/>
            </div>
            <div class="app-title" data-app-theme-color="{{ resource.color }}">
                <span>{{ resource.name }}</span>
            </div>
            <div class="color-effect" data-app-theme-color="{{ resource.color }}"></div>
            <div class="app-help-icon">
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
            </div>
            <div class="app-help-info hidden">
                <p>{% if resource.description %}{{ resource.description }}{% else %}{% endif %}</p>
            </div>
            <div class="app-help-close hidden">X</div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <h2 class="no-apps-loaded-message">There are no apps available on the application store</h2>
    {% endif %}
</div> -->
{% endblock %}


{% block after_app_content %}
<div id="overlay"></div>
{% include "warehouse/modals/mainProcess.html" %}
{% include "warehouse/modals/customSettings.html" %}
{% include "warehouse/modals/services.html" %}
{% include "warehouse/modals/serverOffline.html" %}

{% endblock %}


{% block app_actions %}
<button id="serverStatusOnline" class="btn-success over-overlay" disabled hidden>
    Server Status: Online
</button>
<button id="serverStatusOffline" class="btn-danger over-overlay" disabled hidden>
    Server Status: Offline.
</button>
{% endblock %}

{% block scripts %}
{{ block.super }}
<script>
const resources = JSON.parse('{{ resourcesJson | escapejs }}');
const installURL = "{% url 'warehouse:install' %}";
</script>
<script src="https://unpkg.com/bootstrap-table@1.16.0/dist/bootstrap-table.min.js"></script>
<script src="{% static 'tethys_apps/vendor/imagesloaded.min.js' %}" type="text/javascript"></script>
<script src="{% static 'tethys_apps/vendor/masonry.min.js' %}" type="text/javascript"></script>
<script src="{% static 'tethys_apps/js/app_library.js' %}" type="text/javascript"></script>
<script src="{% static 'tethys_apps/js/isotope.pkgd.min.js' %}" type="text/javascript"></script>
{% endblock %}